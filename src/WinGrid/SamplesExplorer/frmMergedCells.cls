 
 /*------------------------------------------------------------------------
    File        : frmMergedCells
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : hdaniels
    Created     : Mon Jul 21 22:09:03 EDT 2008
    Notes       : 
  ----------------------------------------------------------------------*/

USING Progress.Lang.*.
USING Progress.Windows.Form.
using Infragistics.Win.UltraWinGrid.*.
using System.Drawing.Color.
using WinGrid.SamplesExplorer.*.

CLASS WinGrid.SamplesExplorer.frmMergedCells INHERITS Form IMPLEMENTS ISamplesBase  : 
	
	DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer.
	
	define public variable Panel1 as System.Windows.Forms.Panel no-undo.
	define private variable ultraGroupBoxOtherSettings as Infragistics.Win.Misc.UltraGroupBox no-undo.
	define private variable ultraComboEditorColumnMergedCellEvaluationType as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define private variable ultraComboEditorColumnMergedCellContentArea as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define private variable ultraComboEditorColumnMergedCellStyle as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define private variable ultraComboEditorColumn as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define private variable ultraLabelSelectColumn as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraLabelColumnMergedCellStyle as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraLabelColumnMergedCellContentArea as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraLabelColumnMergedCellEvaluationType as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraButtonColumnMergedCellAppearance as Infragistics.Win.Misc.UltraButton no-undo.
	define private variable ultraGroupBoxMergedCellsSettings as Infragistics.Win.Misc.UltraGroupBox no-undo.
	define private variable ultraButtonOverrideMergedCellAppearance as Infragistics.Win.Misc.UltraButton no-undo.
	define private variable ultraLabelOverrideMergedCellStyle as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraLabelOverrideMergedCellContentArea as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraComboEditorOverrideMergedCellStyle as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define private variable ultraComboEditorOverrideMergedCellContentArea as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define public variable btnTitle as System.Windows.Forms.Button no-undo.

	define private variable UltraGrid1 as Infragistics.Win.UltraWinGrid.UltraGrid no-undo.
	
	/* manual defs */
	define private variable fCustOrderDataSource as DataServices.IDataService no-undo.
    define private variable fAppearancePickerForm as AppearancePicker no-undo.
	
	define public property SelectedColumn as UltraGridColumn no-undo 
	get:
	    return cast(ultraComboEditorColumn:SelectedItem:DataValue,UltraGridColumn).
	end.
	
	/** ISamplesBase properties */
	
	/* Provides a description for the sample. */
	define public property Description as character no-undo 
	get:
	    return "This sample demonstrates the Merged Cells Functionality.".
	end.
	
    /* Name of the sample. */
	define public property SampleName as character no-undo
    get:
        return btnTitle:Text. 
    end.
	
    /* Type of sample. */
	define public property SampleType as character no-undo
	get:
	    return "Feature".
	end.    

	/* Preview Picture for Sample */
	define public property PreviewPicture as System.Drawing.Image no-undo
    get:
        return System.Drawing.Image:FromFile(SamplesPath:GraphicsPath + "/Previews/MergedCells.png").
    end.  

	CONSTRUCTOR PUBLIC frmMergedCells (  ):
		
		SUPER().
		InitializeComponent ( ).

	END CONSTRUCTOR.


	method private void InitializeComponent ( ):

/* 		NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

		We strongly suggest that the contents of this method only be modified using the
		Visual Designer to avoid any incompatible modifications.

		Modifying the contents of this method using a code editor will invalidate any support for this file. */

		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance1 as Infragistics.Win.Appearance no-undo.
		appearance1 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance2 as Infragistics.Win.Appearance no-undo.
		appearance2 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance3 as Infragistics.Win.Appearance no-undo.
		appearance3 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance4 as Infragistics.Win.Appearance no-undo.
		appearance4 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance5 as Infragistics.Win.Appearance no-undo.
		appearance5 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance6 as Infragistics.Win.Appearance no-undo.
		appearance6 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance7 as Infragistics.Win.Appearance no-undo.
		appearance7 = new Infragistics.Win.Appearance().
		this-object:Panel1 = new System.Windows.Forms.Panel().
		this-object:ultraGroupBoxOtherSettings = new Infragistics.Win.Misc.UltraGroupBox().
		this-object:ultraComboEditorColumnMergedCellEvaluationType = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:ultraComboEditorColumnMergedCellContentArea = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:ultraComboEditorColumnMergedCellStyle = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:ultraComboEditorColumn = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:ultraLabelSelectColumn = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraLabelColumnMergedCellStyle = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraLabelColumnMergedCellContentArea = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraLabelColumnMergedCellEvaluationType = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraButtonColumnMergedCellAppearance = new Infragistics.Win.Misc.UltraButton().
		this-object:ultraGroupBoxMergedCellsSettings = new Infragistics.Win.Misc.UltraGroupBox().
		this-object:ultraButtonOverrideMergedCellAppearance = new Infragistics.Win.Misc.UltraButton().
		this-object:ultraLabelOverrideMergedCellStyle = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraLabelOverrideMergedCellContentArea = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraComboEditorOverrideMergedCellStyle = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:ultraComboEditorOverrideMergedCellContentArea = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:btnTitle = new System.Windows.Forms.Button().
		this-object:UltraGrid1 = new Infragistics.Win.UltraWinGrid.UltraGrid().
		this-object:Panel1:SuspendLayout().
		cast(this-object:ultraGroupBoxOtherSettings, System.ComponentModel.ISupportInitialize):BeginInit().
		this-object:ultraGroupBoxOtherSettings:SuspendLayout().
		cast(this-object:ultraComboEditorColumnMergedCellEvaluationType, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraComboEditorColumnMergedCellContentArea, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraComboEditorColumnMergedCellStyle, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraComboEditorColumn, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraGroupBoxMergedCellsSettings, System.ComponentModel.ISupportInitialize):BeginInit().
		this-object:ultraGroupBoxMergedCellsSettings:SuspendLayout().
		cast(this-object:ultraComboEditorOverrideMergedCellStyle, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraComboEditorOverrideMergedCellContentArea, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:UltraGrid1, System.ComponentModel.ISupportInitialize):BeginInit().
		this-object:SuspendLayout().
		/*  */
		/* Panel1 */
		/*  */
		this-object:Panel1:Controls:Add(this-object:ultraGroupBoxOtherSettings).
		this-object:Panel1:Controls:Add(this-object:ultraGroupBoxMergedCellsSettings).
		this-object:Panel1:Controls:Add(this-object:btnTitle).
		this-object:Panel1:Dock = System.Windows.Forms.DockStyle:Top.
		this-object:Panel1:Location = new System.Drawing.Point(0, 0).
		this-object:Panel1:Name = "Panel1".
		this-object:Panel1:Size = new System.Drawing.Size(664, 208).
		this-object:Panel1:TabIndex = 16.
		/*  */
		/* ultraGroupBoxOtherSettings */
		/*  */
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraComboEditorColumnMergedCellEvaluationType).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraComboEditorColumnMergedCellContentArea).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraComboEditorColumnMergedCellStyle).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraComboEditorColumn).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraLabelSelectColumn).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraLabelColumnMergedCellStyle).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraLabelColumnMergedCellContentArea).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraLabelColumnMergedCellEvaluationType).
		this-object:ultraGroupBoxOtherSettings:Controls:Add(this-object:ultraButtonColumnMergedCellAppearance).
		this-object:ultraGroupBoxOtherSettings:Location = new System.Drawing.Point(312, 40).
		this-object:ultraGroupBoxOtherSettings:Name = "ultraGroupBoxOtherSettings".
		this-object:ultraGroupBoxOtherSettings:Size = new System.Drawing.Size(296, 160).
		this-object:ultraGroupBoxOtherSettings:TabIndex = 21.
		this-object:ultraGroupBoxOtherSettings:Text = "Merged Cell Settings - Per Column".
		/*  */
		/* ultraComboEditorColumnMergedCellEvaluationType */
		/*  */
		this-object:ultraComboEditorColumnMergedCellEvaluationType:DropDownStyle = Infragistics.Win.DropDownStyle:DropDownList.
		this-object:ultraComboEditorColumnMergedCellEvaluationType:Location = new System.Drawing.Point(120, 96).
		this-object:ultraComboEditorColumnMergedCellEvaluationType:Name = "ultraComboEditorColumnMergedCellEvaluationType".
		this-object:ultraComboEditorColumnMergedCellEvaluationType:Size = new System.Drawing.Size(160, 21).
		this-object:ultraComboEditorColumnMergedCellEvaluationType:SyncWithCurrencyManager = false.
		this-object:ultraComboEditorColumnMergedCellEvaluationType:TabIndex = 37.
		this-object:ultraComboEditorColumnMergedCellEvaluationType:ValueChanged:subscribe(this-object:ultraComboEditorColumnMergedCellEvaluationType_ValueChanged).
		/*  */
		/* ultraComboEditorColumnMergedCellContentArea */
		/*  */
		this-object:ultraComboEditorColumnMergedCellContentArea:DropDownStyle = Infragistics.Win.DropDownStyle:DropDownList.
		this-object:ultraComboEditorColumnMergedCellContentArea:Location = new System.Drawing.Point(120, 72).
		this-object:ultraComboEditorColumnMergedCellContentArea:Name = "ultraComboEditorColumnMergedCellContentArea".
		this-object:ultraComboEditorColumnMergedCellContentArea:Size = new System.Drawing.Size(160, 21).
		this-object:ultraComboEditorColumnMergedCellContentArea:SyncWithCurrencyManager = false.
		this-object:ultraComboEditorColumnMergedCellContentArea:TabIndex = 36.
		this-object:ultraComboEditorColumnMergedCellContentArea:ValueChanged:subscribe(this-object:ultraComboEditorColumnMergedCellContentArea_ValueChanged).
		/*  */
		/* ultraComboEditorColumnMergedCellStyle */
		/*  */
		this-object:ultraComboEditorColumnMergedCellStyle:DropDownStyle = Infragistics.Win.DropDownStyle:DropDownList.
		this-object:ultraComboEditorColumnMergedCellStyle:Location = new System.Drawing.Point(120, 48).
		this-object:ultraComboEditorColumnMergedCellStyle:Name = "ultraComboEditorColumnMergedCellStyle".
		this-object:ultraComboEditorColumnMergedCellStyle:Size = new System.Drawing.Size(160, 21).
		this-object:ultraComboEditorColumnMergedCellStyle:SyncWithCurrencyManager = false.
		this-object:ultraComboEditorColumnMergedCellStyle:TabIndex = 35.
		this-object:ultraComboEditorColumnMergedCellStyle:ValueChanged:subscribe(this-object:ultraComboEditorColumnMergedCellStyle_ValueChanged).
		/*  */
		/* ultraComboEditorColumn */
		/*  */
		this-object:ultraComboEditorColumn:DropDownListAlignment = Infragistics.Win.DropDownListAlignment:Right.
		this-object:ultraComboEditorColumn:DropDownListWidth = -1.
		this-object:ultraComboEditorColumn:DropDownStyle = Infragistics.Win.DropDownStyle:DropDownList.
		this-object:ultraComboEditorColumn:Location = new System.Drawing.Point(120, 24).
		this-object:ultraComboEditorColumn:Name = "ultraComboEditorColumn".
		this-object:ultraComboEditorColumn:Size = new System.Drawing.Size(160, 21).
		this-object:ultraComboEditorColumn:SyncWithCurrencyManager = false.
		this-object:ultraComboEditorColumn:TabIndex = 34.
		this-object:ultraComboEditorColumn:ValueChanged:subscribe(this-object:ultraComboEditorColumn_ValueChanged).
		/*  */
		/* ultraLabelSelectColumn */
		/*  */
		appearance1:FontData:BoldAsString = "True".
		this-object:ultraLabelSelectColumn:Appearance = appearance1.
		this-object:ultraLabelSelectColumn:Location = new System.Drawing.Point(16, 24).
		this-object:ultraLabelSelectColumn:Name = "ultraLabelSelectColumn".
		this-object:ultraLabelSelectColumn:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabelSelectColumn:TabIndex = 22.
		this-object:ultraLabelSelectColumn:Text = "Select Column:".
		/*  */
		/* ultraLabelColumnMergedCellStyle */
		/*  */
		this-object:ultraLabelColumnMergedCellStyle:Location = new System.Drawing.Point(16, 48).
		this-object:ultraLabelColumnMergedCellStyle:Name = "ultraLabelColumnMergedCellStyle".
		this-object:ultraLabelColumnMergedCellStyle:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabelColumnMergedCellStyle:TabIndex = 28.
		this-object:ultraLabelColumnMergedCellStyle:Text = "Style:".
		/*  */
		/* ultraLabelColumnMergedCellContentArea */
		/*  */
		this-object:ultraLabelColumnMergedCellContentArea:Location = new System.Drawing.Point(16, 72).
		this-object:ultraLabelColumnMergedCellContentArea:Name = "ultraLabelColumnMergedCellContentArea".
		this-object:ultraLabelColumnMergedCellContentArea:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabelColumnMergedCellContentArea:TabIndex = 32.
		this-object:ultraLabelColumnMergedCellContentArea:Text = "Content Area:".
		/*  */
		/* ultraLabelColumnMergedCellEvaluationType */
		/*  */
		this-object:ultraLabelColumnMergedCellEvaluationType:Location = new System.Drawing.Point(16, 96).
		this-object:ultraLabelColumnMergedCellEvaluationType:Name = "ultraLabelColumnMergedCellEvaluationType".
		this-object:ultraLabelColumnMergedCellEvaluationType:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabelColumnMergedCellEvaluationType:TabIndex = 33.
		this-object:ultraLabelColumnMergedCellEvaluationType:Text = "Evaluation Type:".
		/*  */
		/* ultraButtonColumnMergedCellAppearance */
		/*  */
		this-object:ultraButtonColumnMergedCellAppearance:Location = new System.Drawing.Point(120, 128).
		this-object:ultraButtonColumnMergedCellAppearance:Name = "ultraButtonColumnMergedCellAppearance".
		this-object:ultraButtonColumnMergedCellAppearance:Size = new System.Drawing.Size(160, 23).
		this-object:ultraButtonColumnMergedCellAppearance:TabIndex = 27.
		this-object:ultraButtonColumnMergedCellAppearance:Text = "Merged Cell Appearance".
		this-object:ultraButtonColumnMergedCellAppearance:Click:subscribe(this-object:ultraButtonColumnMergedCellAppearance_Click).
		/*  */
		/* ultraGroupBoxMergedCellsSettings */
		/*  */
		this-object:ultraGroupBoxMergedCellsSettings:Controls:Add(this-object:ultraButtonOverrideMergedCellAppearance).
		this-object:ultraGroupBoxMergedCellsSettings:Controls:Add(this-object:ultraLabelOverrideMergedCellStyle).
		this-object:ultraGroupBoxMergedCellsSettings:Controls:Add(this-object:ultraLabelOverrideMergedCellContentArea).
		this-object:ultraGroupBoxMergedCellsSettings:Controls:Add(this-object:ultraComboEditorOverrideMergedCellStyle).
		this-object:ultraGroupBoxMergedCellsSettings:Controls:Add(this-object:ultraComboEditorOverrideMergedCellContentArea).
		this-object:ultraGroupBoxMergedCellsSettings:Location = new System.Drawing.Point(8, 40).
		this-object:ultraGroupBoxMergedCellsSettings:Name = "ultraGroupBoxMergedCellsSettings".
		this-object:ultraGroupBoxMergedCellsSettings:Size = new System.Drawing.Size(296, 120).
		this-object:ultraGroupBoxMergedCellsSettings:TabIndex = 20.
		this-object:ultraGroupBoxMergedCellsSettings:Text = "Merged Cell Settings - Grid Wide".
		this-object:ultraGroupBoxMergedCellsSettings:UseMnemonic = false.
		/*  */
		/* ultraButtonOverrideMergedCellAppearance */
		/*  */
		this-object:ultraButtonOverrideMergedCellAppearance:Location = new System.Drawing.Point(120, 80).
		this-object:ultraButtonOverrideMergedCellAppearance:Name = "ultraButtonOverrideMergedCellAppearance".
		this-object:ultraButtonOverrideMergedCellAppearance:Size = new System.Drawing.Size(160, 23).
		this-object:ultraButtonOverrideMergedCellAppearance:TabIndex = 25.
		this-object:ultraButtonOverrideMergedCellAppearance:Text = "Merged Cell Appearance".
		this-object:ultraButtonOverrideMergedCellAppearance:Click:subscribe(this-object:ultraButtonOverrideMergedCellAppearance_Click).
		/*  */
		/* ultraLabelOverrideMergedCellStyle */
		/*  */
		this-object:ultraLabelOverrideMergedCellStyle:Location = new System.Drawing.Point(16, 24).
		this-object:ultraLabelOverrideMergedCellStyle:Name = "ultraLabelOverrideMergedCellStyle".
		this-object:ultraLabelOverrideMergedCellStyle:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabelOverrideMergedCellStyle:TabIndex = 24.
		this-object:ultraLabelOverrideMergedCellStyle:Text = "Style:".
		/*  */
		/* ultraLabelOverrideMergedCellContentArea */
		/*  */
		this-object:ultraLabelOverrideMergedCellContentArea:Location = new System.Drawing.Point(16, 48).
		this-object:ultraLabelOverrideMergedCellContentArea:Name = "ultraLabelOverrideMergedCellContentArea".
		this-object:ultraLabelOverrideMergedCellContentArea:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabelOverrideMergedCellContentArea:TabIndex = 24.
		this-object:ultraLabelOverrideMergedCellContentArea:Text = "Content Area:".
		/*  */
		/* ultraComboEditorOverrideMergedCellStyle */
		/*  */
		this-object:ultraComboEditorOverrideMergedCellStyle:DropDownStyle = Infragistics.Win.DropDownStyle:DropDownList.
		this-object:ultraComboEditorOverrideMergedCellStyle:Location = new System.Drawing.Point(120, 24).
		this-object:ultraComboEditorOverrideMergedCellStyle:Name = "ultraComboEditorOverrideMergedCellStyle".
		this-object:ultraComboEditorOverrideMergedCellStyle:Size = new System.Drawing.Size(160, 21).
		this-object:ultraComboEditorOverrideMergedCellStyle:SyncWithCurrencyManager = false.
		this-object:ultraComboEditorOverrideMergedCellStyle:TabIndex = 22.
		this-object:ultraComboEditorOverrideMergedCellStyle:ValueChanged:subscribe(this-object:ultraComboEditorOverrideMergedCellStyle_ValueChanged).
		/*  */
		/* ultraComboEditorOverrideMergedCellContentArea */
		/*  */
		this-object:ultraComboEditorOverrideMergedCellContentArea:DropDownStyle = Infragistics.Win.DropDownStyle:DropDownList.
		this-object:ultraComboEditorOverrideMergedCellContentArea:Location = new System.Drawing.Point(120, 48).
		this-object:ultraComboEditorOverrideMergedCellContentArea:Name = "ultraComboEditorOverrideMergedCellContentArea".
		this-object:ultraComboEditorOverrideMergedCellContentArea:Size = new System.Drawing.Size(160, 21).
		this-object:ultraComboEditorOverrideMergedCellContentArea:SyncWithCurrencyManager = false.
		this-object:ultraComboEditorOverrideMergedCellContentArea:TabIndex = 23.
		this-object:ultraComboEditorOverrideMergedCellContentArea:ValueChanged:subscribe(this-object:ultraComboEditorOverrideMergedCellContentArea_ValueChanged).
		/*  */
		/* btnTitle */
		/*  */
		this-object:btnTitle:Dock = System.Windows.Forms.DockStyle:Top.
		this-object:btnTitle:FlatStyle = System.Windows.Forms.FlatStyle:Flat.
		this-object:btnTitle:Font = new System.Drawing.Font("Arial", 14.25, System.Drawing.FontStyle:Bold, System.Drawing.GraphicsUnit:Point, Progress.Util.CastUtil:ToByte(0)).
		this-object:btnTitle:Location = new System.Drawing.Point(0, 0).
		this-object:btnTitle:Name = "btnTitle".
		this-object:btnTitle:Size = new System.Drawing.Size(664, 32).
		this-object:btnTitle:TabIndex = 13.
		this-object:btnTitle:Text = "Merged Cells Feature".
		this-object:btnTitle:TextAlign = System.Drawing.ContentAlignment:MiddleLeft.
		this-object:btnTitle:UseCompatibleTextRendering = true.
		this-object:btnTitle:MouseUp:subscribe(this-object:btnTitle_MouseUp).
		/*  */
		/* UltraGrid1 */
		/*  */
		this-object:UltraGrid1:Anchor = cast(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Bottom), System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
		appearance2:BackColor = System.Drawing.Color:White.
		appearance2:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(61)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(149)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(255))).
		appearance2:BackGradientStyle = Infragistics.Win.GradientStyle:ForwardDiagonal.
		this-object:UltraGrid1:DisplayLayout:Appearance = appearance2.
		this-object:UltraGrid1:DisplayLayout:InterBandSpacing = 10.
		appearance3:BackColor = System.Drawing.Color:Transparent.
		this-object:UltraGrid1:DisplayLayout:Override:CardAreaAppearance = appearance3.
		appearance4:BackColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(61)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(149)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(255))).
		appearance4:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(1)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(68)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(208))).
		appearance4:BackGradientStyle = Infragistics.Win.GradientStyle:Vertical.
		appearance4:ForeColor = System.Drawing.Color:White.
		appearance4:TextHAlignAsString = "Left".
		appearance4:ThemedElementAlpha = Infragistics.Win.Alpha:Transparent.
		this-object:UltraGrid1:DisplayLayout:Override:HeaderAppearance = appearance4.
		appearance5:BorderColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(1)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(68)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(208))).
		this-object:UltraGrid1:DisplayLayout:Override:RowAppearance = appearance5.
		appearance6:BackColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(61)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(149)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(255))).
		appearance6:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(1)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(68)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(208))).
		appearance6:BackGradientStyle = Infragistics.Win.GradientStyle:Vertical.
		this-object:UltraGrid1:DisplayLayout:Override:RowSelectorAppearance = appearance6.
		this-object:UltraGrid1:DisplayLayout:Override:RowSelectorWidth = 12.
		appearance7:BackColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(129)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(169)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(226))).
		appearance7:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(221)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(235)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(254))).
		appearance7:BackGradientStyle = Infragistics.Win.GradientStyle:Vertical.
		appearance7:ForeColor = System.Drawing.Color:Black.
		this-object:UltraGrid1:DisplayLayout:Override:SelectedRowAppearance = appearance7.
		this-object:UltraGrid1:DisplayLayout:RowConnectorColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(1)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(68)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(208))).
		this-object:UltraGrid1:DisplayLayout:RowConnectorStyle = Infragistics.Win.UltraWinGrid.RowConnectorStyle:Solid.
		this-object:UltraGrid1:Location = new System.Drawing.Point(0, 214).
		this-object:UltraGrid1:Name = "UltraGrid1".
		this-object:UltraGrid1:Size = new System.Drawing.Size(664, 288).
		this-object:UltraGrid1:TabIndex = 17.
		this-object:UltraGrid1:InitializeLayout:subscribe(this-object:UltraGrid1_InitializeLayout).
		/*  */
		/* frmMergedCells */
		/*  */
		this-object:ClientSize = new System.Drawing.Size(664, 502).
		this-object:Controls:Add(this-object:UltraGrid1).
		this-object:Controls:Add(this-object:Panel1).
		this-object:Name = "frmMergedCells".
		this-object:Text = "MergedCells".
		this-object:Load:subscribe(this-object:frmMergedCells_Load).
		this-object:FormClosing:subscribe(this-object:frmMergedCells_FormClosing).
		this-object:Panel1:ResumeLayout(false).
		cast(this-object:ultraGroupBoxOtherSettings, System.ComponentModel.ISupportInitialize):EndInit().
		this-object:ultraGroupBoxOtherSettings:ResumeLayout(false).
		this-object:ultraGroupBoxOtherSettings:PerformLayout().
		cast(this-object:ultraComboEditorColumnMergedCellEvaluationType, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraComboEditorColumnMergedCellContentArea, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraComboEditorColumnMergedCellStyle, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraComboEditorColumn, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraGroupBoxMergedCellsSettings, System.ComponentModel.ISupportInitialize):EndInit().
		this-object:ultraGroupBoxMergedCellsSettings:ResumeLayout(false).
		this-object:ultraGroupBoxMergedCellsSettings:PerformLayout().
		cast(this-object:ultraComboEditorOverrideMergedCellStyle, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraComboEditorOverrideMergedCellContentArea, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:UltraGrid1, System.ComponentModel.ISupportInitialize):EndInit().
		this-object:ResumeLayout(false).

	end method.

    method private void CreateAppearancePicker():
	    if valid-object(fAppearancePickerForm ) then
		do:
		    fAppearancePickerForm:Close().
			fAppearancePickerForm:Dispose().
		end.
		
		fAppearancePickerForm = new AppearancePicker().
	end method. 
	
	method private void LoadColumnsCombo(ultraCombo as Infragistics.Win.UltraWinEditors.UltraComboEditor , layout as Infragistics.Win.UltraWinGrid.UltraGridLayout  ):
		define variable bands as Infragistics.Win.UltraWinGrid.BandsCollection no-undo.
		define variable bandColumns as Infragistics.Win.UltraWinGrid.ColumnsCollection no-undo.
        define variable oBand as Infragistics.Win.UltraWinGrid.UltraGridBand no-undo.
        define variable oColumn as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
        define variable iBand as integer no-undo.
        define variable iColumn as integer no-undo.
          
		bands = layout:Bands.
		do iBand = 0 to bands:Count - 1:
		    oBand = bands[iBand].
		    bandColumns = oBand:Columns.
		    do iColumn = 0 to bandColumns:Count - 1:
		        oColumn = bandColumns[iColumn].
		        ultraCombo:Items:Add(oColumn,oColumn:Band:Key + " - " + oColumn:Header:Caption).
		    end.
		end. 
		/* select first entry */
		if ultraCombo:Items:Count > 0 then
			ultraCombo:SelectedIndex = 0.
	end method.
	
    method private void LoadEnumCombo(ultraCombo as Infragistics.Win.UltraWinEditors.UltraComboEditor, enumTypeName as char ):
		define var enumTypes as System.Array no-undo.
		define var type as System.Type no-undo.
		define var i as integer no-undo.
		
		type = Progress.Util.TypeHelper:GetType(enumTypeName).
		 
		enumTypes = System.Enum:GetValues( type ).
 
		ultraCombo:Items:Clear( ).
		do i = 0 to enumTypes:Length - 1:
		    ultraCombo:Items:Add( enumTypes:GetValue(i)).
		end.
	end method.
	
    method protected Progress.Data.BindingSource GetCustOrderSource():   
        if not valid-object(fCustOrderDataSource) then
        do:
            fCustOrderDataSource = new DataServices.CustOrderService().                  
            fCustOrderDataSource:fetchData().                                                 
        end.
        return new Progress.Data.BindingSource(fCustOrderDataSource:DataSetHandle).
    end method. 
    
    /* implements ISamplesBase interface  */
    method public void ShowMe( owner as System.Windows.Forms.Form  ):
/*		InitializeForm().*/
        
         if (owner <> ?) then
			this-object:Owner = owner. 
		this-object:Show().
	    this-object:CancelButton = btnTitle.
        this-object:CenterToScreen().
		this-object:MaximizeBox = true.
	end.	

    /* implements ISamplesBase interface  */
    method public void HideMe( ):
        this-object:Hide().   
    end.
	
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmMergedCells_FormClosing( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.FormClosingEventArgs ):
		if valid-object(this-object:Owner) then
        do:
    		e:Cancel = true.
    		this-object:Visible = false.
		end.
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID btnTitle_MouseUp( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.MouseEventArgs ):
		if valid-object(this-object:Owner) then
		    (cast (this-object:Owner,frmMain)):Navigation(e:Button).
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmMergedCells_Load( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		/* Hide the grid caption by setting the Text to empty string. */
	    UltraGrid1:Text = "".
		UltraGrid1:DataSource = GetCustOrderSource().	
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID UltraGrid1_InitializeLayout( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs ):
		/* MERGED CELL FUNCTIONALITY RELATED ULTRAGRID SETTINGS
		 ------------------------------------------------------------------------ */
		
		/* Set the merged cell style to the OnlyWhenSorted. */
		e:Layout:Override:MergedCellStyle = MergedCellStyle:OnlyWhenSorted.
		e:Layout:Override:MergedCellContentArea = MergedCellContentArea:VirtualRect.
		e:Layout:Override:HeaderClickAction = HeaderClickAction:SortMulti.
		e:Layout:Override:MergedCellAppearance:BackColor = Color:LightYellow.
		
		/*---------------------------------------------------------------------
		  OTHER MISCELLANEOUS ULTRAGRID SETTINGS
		  ---------------------------------------------------------------------*/
        /* Enable group-by functionality.*/
		e:Layout:ViewStyleBand = ViewStyleBand:OutlookGroupBy.

		/* Show add-row. */
		e:Layout:Override:AllowAddNew = AllowAddNew:TemplateOnBottom.

		/* Set the scroll style to immediate so the rows get scrolled immediately */
		/* when the vertical scrollbar thumb is dragged. */
		e:Layout:ScrollStyle = ScrollStyle:Immediate.

		/* ScrollBounds of ScrollToFill will prevent the user from scrolling the */
		/* grid further down once the last row becomes fully visible. */
		e:Layout:ScrollBounds = ScrollBounds:ScrollToFill.

		/* Enable fixed headers functionality. This will freeze the row selectors. */
		e:Layout:UseFixedHeaders = true.

		/* Show add row. */
		e:Layout:Override:AllowAddNew = AllowAddNew:TemplateOnBottom.

		/* Sort by Country and then the State. */
		e:Layout:Bands[0]:SortedColumns:Add( "Country", false ).
		e:Layout:Bands[0]:SortedColumns:Add( "State", false ).

		/* Reorder the columns. */
		e:Layout:Bands[0]:Columns["Country"]:Header:VisiblePosition = 0.
		e:Layout:Bands[0]:Columns["State"]:Header:VisiblePosition = 1.
		e:Layout:Bands[0]:Columns["City"]:Header:VisiblePosition = 2.
		
		/* ---------------------------------------------------------------------
		  INITIALIZE CONTROLS ON THE FORM.
		  ---------------------------------------------------------------------*/
		LoadEnumCombo( ultraComboEditorOverrideMergedCellStyle,"Infragistics.Win.UltraWinGrid.MergedCellStyle").
		LoadEnumCombo( ultraComboEditorOverrideMergedCellContentArea,"Infragistics.Win.UltraWinGrid.MergedCellContentArea").
		LoadEnumCombo( ultraComboEditorColumnMergedCellStyle,"Infragistics.Win.UltraWinGrid.MergedCellStyle").
		LoadEnumCombo( ultraComboEditorColumnMergedCellContentArea,"Infragistics.Win.UltraWinGrid.MergedCellContentArea").
		LoadEnumCombo( ultraComboEditorColumnMergedCellEvaluationType,"Infragistics.Win.UltraWinGrid.MergedCellEvaluationType").
	    LoadColumnsCombo(ultraComboEditorColumn, UltraGrid1:DisplayLayout ).	
	
		/* Initialize the combos to their initial values. */
		ultraComboEditorOverrideMergedCellStyle:Value = e:Layout:Override:MergedCellStyle.
		ultraComboEditorOverrideMergedCellContentArea:Value = e:Layout:Override:MergedCellContentArea.
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditorOverrideMergedCellStyle_ValueChanged( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
	    define variable style as MergedCellStyle no-undo.
	    style = cast(ultraComboEditorOverrideMergedCellStyle:Value,MergedCellStyle).
	    UltraGrid1:DisplayLayout:Override:MergedCellStyle = style.	
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditorOverrideMergedCellContentArea_ValueChanged( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		define variable area as MergedCellContentArea no-undo.
	    area = cast(ultraComboEditorOverrideMergedCellContentArea:Value,MergedCellContentArea).
	    UltraGrid1:DisplayLayout:Override:MergedCellContentArea = area.	
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditorColumn_ValueChanged( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		define variable validCol as logical no-undo.
        
        validCol = valid-object(SelectedColumn).
        
		ultraComboEditorColumnMergedCellStyle:Enabled = validCol.
		ultraComboEditorColumnMergedCellContentArea:Enabled = validCol.
		ultraComboEditorColumnMergedCellEvaluationType:Enabled = validCol.
		ultraButtonColumnMergedCellAppearance:Enabled = validCol.

		if validCol then 
		do:
			ultraComboEditorColumnMergedCellStyle:Value = SelectedColumn:MergedCellStyle.
			ultraComboEditorColumnMergedCellContentArea:Value = SelectedColumn:MergedCellContentArea.
			ultraComboEditorColumnMergedCellEvaluationType:Value = SelectedColumn:MergedCellEvaluationType.
		end.
		else
		do:
			ultraComboEditorColumnMergedCellStyle:Value = MergedCellStyle:Default.
			ultraComboEditorColumnMergedCellContentArea:Value = MergedCellContentArea:Default.
			ultraComboEditorColumnMergedCellEvaluationType:Value = MergedCellEvaluationType:Default.
		end.
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditorColumnMergedCellStyle_ValueChanged( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
	    if valid-object(SelectedColumn) then
		    SelectedColumn:MergedCellStyle = cast(ultraComboEditorColumnMergedCellStyle:Value,MergedCellStyle).				
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditorColumnMergedCellContentArea_ValueChanged( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
	    if valid-object(SelectedColumn) then
		    SelectedColumn:MergedCellContentArea = cast(ultraComboEditorColumnMergedCellContentArea:Value,MergedCellContentArea).
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditorColumnMergedCellEvaluationType_ValueChanged( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
	    if valid-object(SelectedColumn) then
		    SelectedColumn:MergedCellEvaluationType = cast(ultraComboEditorColumnMergedCellEvaluationType:Value,MergedCellEvaluationType).				
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraButtonOverrideMergedCellAppearance_Click( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		CreateAppearancePicker( ).
		fAppearancePickerForm:ShowMe(UltraGrid1:DisplayLayout:Override:MergedCellAppearance,
				                    "Merged Cell Appearance" ).
		RETURN.

	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraButtonColumnMergedCellAppearance_Click( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		CreateAppearancePicker( ).
		if valid-object(SelectedColumn) then
		    fAppearancePickerForm:ShowMe(SelectedColumn:MergedCellAppearance,				
					                     SelectedColumn:Header:Caption + ": Merged Cell Appearance" ).
		RETURN.
	END METHOD.

	DESTRUCTOR PUBLIC frmMergedCells ( ):

		IF VALID-OBJECT(components) THEN DO:
			CAST(components, System.IDisposable):Dispose().
		END.

	END DESTRUCTOR.

END CLASS.