 
 /*------------------------------------------------------------------------
    File        : frmFormulas
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : hdaniels
    Created     : Fri Jul 25 14:55:52 EDT 2008
    Notes       : 
  ----------------------------------------------------------------------*/

USING Progress.Lang.*.
USING Progress.Windows.Form.
using Infragistics.Win.UltraWinGrid.*.
using Progress.Util.TypeHelper.
using System.Drawing.Rectangle.

using WinGrid.SamplesExplorer.*.
 
 
CLASS WinGrid.SamplesExplorer.frmFormulas INHERITS Form IMPLEMENTS ISamplesBase  : 
	
	DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer.
	
    define public variable Panel1 as System.Windows.Forms.Panel no-undo.
	define public variable btnTitle as System.Windows.Forms.Button no-undo.
	define private variable ultraButtonSetFormula as Infragistics.Win.Misc.UltraButton no-undo.
	define private variable ultraComboEditor_Formula as Infragistics.Win.UltraWinEditors.UltraComboEditor no-undo.
	define private variable ultraLabel2 as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable ultraLabel1 as Infragistics.Win.Misc.UltraLabel no-undo.
	define private variable textBox1 as System.Windows.Forms.TextBox no-undo.
	define public variable lblDescription as System.Windows.Forms.Label no-undo.

	define private variable UltraGrid1 as Infragistics.Win.UltraWinGrid.UltraGrid no-undo.
	
	/* MANUAL DEFS */
	define private variable CategoryItemService as DataServices.IDataService no-undo.
	
	define private variable fToolTipValue as Infragistics.Win.ToolTip no-undo. 
	
	define private property ToolTip as Infragistics.Win.ToolTip no-undo
	get:
		if not valid-object(fToolTipValue) then
        do:
            fToolTipValue = new Infragistics.Win.ToolTip( this-object ).
			fToolTipValue:DisplayShadow = true.
			fToolTipValue:AutoPopDelay = 10000.
		end.
		return fToolTipValue.
	end.
		
    /** ISamplesBase properties */
	
	/* Provides a description for the sample. */
	define public property Description as character no-undo 
	get:
	    return lblDescription:Text.
	end.
	
    /* Name of the sample. */
	define public property SampleName as character no-undo
    get:
        return btnTitle:Text. 
    end.
	
    /* Type of sample. */
	define public property SampleType as character no-undo
	get:
	    return "Feature".
	end.    

	/* Preview Picture for Sample */
	define public property PreviewPicture as System.Drawing.Image no-undo
    get:
        return System.Drawing.Image:FromFile(SamplesPath:GraphicsPath + "/Previews/Formulas.png").
    end.  

	define private variable ultraCalcManager1 as Infragistics.Win.UltraWinCalcManager.UltraCalcManager no-undo.


	define private variable bindingSource1 as Progress.Data.BindingSource no-undo.
		
	CONSTRUCTOR PUBLIC frmFormulas (  ):		
		SUPER().
		InitializeComponent ( ).
	END CONSTRUCTOR.

	method private void InitializeComponent ( ):

/* 		NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

		We strongly suggest that the contents of this method only be modified using the
		Visual Designer to avoid any incompatible modifications.

		Modifying the contents of this method using a code editor will invalidate any support for this file. */

		this-object:components = new System.ComponentModel.Container().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem1 as Infragistics.Win.ValueListItem no-undo.
		valueListItem1 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem2 as Infragistics.Win.ValueListItem no-undo.
		valueListItem2 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem3 as Infragistics.Win.ValueListItem no-undo.
		valueListItem3 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem4 as Infragistics.Win.ValueListItem no-undo.
		valueListItem4 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem5 as Infragistics.Win.ValueListItem no-undo.
		valueListItem5 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem6 as Infragistics.Win.ValueListItem no-undo.
		valueListItem6 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem7 as Infragistics.Win.ValueListItem no-undo.
		valueListItem7 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem8 as Infragistics.Win.ValueListItem no-undo.
		valueListItem8 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable valueListItem9 as Infragistics.Win.ValueListItem no-undo.
		valueListItem9 = new Infragistics.Win.ValueListItem().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable resources as System.Resources.ResXResourceSet no-undo.
		resources = Progress.Util.ResourceHelper:Load("WinGrid/SamplesExplorer/frmFormulas.resx", PROPATH).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable tableDesc1 as Progress.Data.TableDesc no-undo.
		tableDesc1 = new Progress.Data.TableDesc("Item").
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance31 as Infragistics.Win.Appearance no-undo.
		appearance31 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridBand1 as Infragistics.Win.UltraWinGrid.UltraGridBand no-undo.
		ultraGridBand1 = new Infragistics.Win.UltraWinGrid.UltraGridBand("Item", -1).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn1 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn1 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("ItemNum").
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn2 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn2 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("Category1").
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn3 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn3 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("Category2").
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn4 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn4 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("Price").
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance1 as Infragistics.Win.Appearance no-undo.
		appearance1 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn5 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn5 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("Qty", -1, ?, 0, Infragistics.Win.UltraWinGrid.SortIndicator:Descending, false).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance2 as Infragistics.Win.Appearance no-undo.
		appearance2 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn6 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn6 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("Total").
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance3 as Infragistics.Win.Appearance no-undo.
		appearance3 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable ultraGridColumn7 as Infragistics.Win.UltraWinGrid.UltraGridColumn no-undo.
		ultraGridColumn7 = new Infragistics.Win.UltraWinGrid.UltraGridColumn("TestCol", 0).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable summarySettings1 as Infragistics.Win.UltraWinGrid.SummarySettings no-undo.
		summarySettings1 = new Infragistics.Win.UltraWinGrid.SummarySettings("CaptionDummySummary", Infragistics.Win.UltraWinGrid.SummaryType:Formula, ?, ?, -1, false, ?, -1, Infragistics.Win.UltraWinGrid.SummaryPosition:UseSummaryPositionColumn, "Total", 5, true).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance4 as Infragistics.Win.Appearance no-undo.
		appearance4 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance5 as Infragistics.Win.Appearance no-undo.
		appearance5 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable summarySettings2 as Infragistics.Win.UltraWinGrid.SummarySettings no-undo.
		summarySettings2 = new Infragistics.Win.UltraWinGrid.SummarySettings("Summary_Totals", Infragistics.Win.UltraWinGrid.SummaryType:Formula, "sum( [Total] )", ?, -1, false, ?, -1, Infragistics.Win.UltraWinGrid.SummaryPosition:UseSummaryPositionColumn, "Total", 5, true).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance6 as Infragistics.Win.Appearance no-undo.
		appearance6 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance7 as Infragistics.Win.Appearance no-undo.
		appearance7 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable summarySettings3 as Infragistics.Win.UltraWinGrid.SummarySettings no-undo.
		summarySettings3 = new Infragistics.Win.UltraWinGrid.SummarySettings("Summary_SalesTax", Infragistics.Win.UltraWinGrid.SummaryType:Formula, "( [//SalesTaxRate] / 100 ) * [Summary_Totals()]", ?, -1, false, ?, -1, Infragistics.Win.UltraWinGrid.SummaryPosition:UseSummaryPositionColumn, "Total", 5, true).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance8 as Infragistics.Win.Appearance no-undo.
		appearance8 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance9 as Infragistics.Win.Appearance no-undo.
		appearance9 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable summarySettings4 as Infragistics.Win.UltraWinGrid.SummarySettings no-undo.
		summarySettings4 = new Infragistics.Win.UltraWinGrid.SummarySettings("Summary_Net", Infragistics.Win.UltraWinGrid.SummaryType:Formula, "[Summary_Totals()] + [Summary_SalesTax()]", ?, -1, false, ?, -1, Infragistics.Win.UltraWinGrid.SummaryPosition:UseSummaryPositionColumn, "Total", 5, true).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance10 as Infragistics.Win.Appearance no-undo.
		appearance10 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance11 as Infragistics.Win.Appearance no-undo.
		appearance11 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance43 as Infragistics.Win.Appearance no-undo.
		appearance43 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance44 as Infragistics.Win.Appearance no-undo.
		appearance44 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance45 as Infragistics.Win.Appearance no-undo.
		appearance45 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance46 as Infragistics.Win.Appearance no-undo.
		appearance46 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance47 as Infragistics.Win.Appearance no-undo.
		appearance47 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance48 as Infragistics.Win.Appearance no-undo.
		appearance48 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance49 as Infragistics.Win.Appearance no-undo.
		appearance49 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance50 as Infragistics.Win.Appearance no-undo.
		appearance50 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance51 as Infragistics.Win.Appearance no-undo.
		appearance51 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable appearance52 as Infragistics.Win.Appearance no-undo.
		appearance52 = new Infragistics.Win.Appearance().
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable rowScrollRegion1 as Infragistics.Win.UltraWinGrid.RowScrollRegion no-undo.
		rowScrollRegion1 = new Infragistics.Win.UltraWinGrid.RowScrollRegion(0).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable rowScrollRegion2 as Infragistics.Win.UltraWinGrid.RowScrollRegion no-undo.
		rowScrollRegion2 = new Infragistics.Win.UltraWinGrid.RowScrollRegion(336).
		@VisualDesigner.FormMember (NeedsInitialize="true").
		define variable rowScrollRegion3 as Infragistics.Win.UltraWinGrid.RowScrollRegion no-undo.
		rowScrollRegion3 = new Infragistics.Win.UltraWinGrid.RowScrollRegion(-48).
		this-object:Panel1 = new System.Windows.Forms.Panel().
		this-object:btnTitle = new System.Windows.Forms.Button().
		this-object:ultraButtonSetFormula = new Infragistics.Win.Misc.UltraButton().
		this-object:ultraComboEditor_Formula = new Infragistics.Win.UltraWinEditors.UltraComboEditor().
		this-object:ultraLabel2 = new Infragistics.Win.Misc.UltraLabel().
		this-object:ultraLabel1 = new Infragistics.Win.Misc.UltraLabel().
		this-object:textBox1 = new System.Windows.Forms.TextBox().
		this-object:lblDescription = new System.Windows.Forms.Label().
		this-object:ultraCalcManager1 = new Infragistics.Win.UltraWinCalcManager.UltraCalcManager(this-object:components).
		this-object:bindingSource1 = new Progress.Data.BindingSource().
		this-object:UltraGrid1 = new Infragistics.Win.UltraWinGrid.UltraGrid().
		this-object:Panel1:SuspendLayout().
		cast(this-object:ultraComboEditor_Formula, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraCalcManager1, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:bindingSource1, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:UltraGrid1, System.ComponentModel.ISupportInitialize):BeginInit().
		this-object:SuspendLayout().
		/*  */
		/* Panel1 */
		/*  */
		this-object:Panel1:Controls:Add(this-object:btnTitle).
		this-object:Panel1:Dock = System.Windows.Forms.DockStyle:Top.
		this-object:Panel1:Location = new System.Drawing.Point(0, 0).
		this-object:Panel1:Name = "Panel1".
		this-object:Panel1:Size = new System.Drawing.Size(704, 32).
		this-object:Panel1:TabIndex = 16.
		/*  */
		/* btnTitle */
		/*  */
		this-object:btnTitle:Dock = System.Windows.Forms.DockStyle:Top.
		this-object:btnTitle:FlatStyle = System.Windows.Forms.FlatStyle:Flat.
		this-object:btnTitle:Font = new System.Drawing.Font("Arial", 14.25, System.Drawing.FontStyle:Bold, System.Drawing.GraphicsUnit:Point, Progress.Util.CastUtil:ToByte(0)).
		this-object:btnTitle:Location = new System.Drawing.Point(0, 0).
		this-object:btnTitle:Name = "btnTitle".
		this-object:btnTitle:Size = new System.Drawing.Size(704, 32).
		this-object:btnTitle:TabIndex = 13.
		this-object:btnTitle:Text = "Formula Support".
		this-object:btnTitle:TextAlign = System.Drawing.ContentAlignment:MiddleLeft.
		this-object:btnTitle:UseCompatibleTextRendering = true.
		this-object:btnTitle:MouseUp:subscribe(this-object:btnTitle_MouseUp).
		/*  */
		/* ultraButtonSetFormula */
		/*  */
		this-object:ultraButtonSetFormula:Location = new System.Drawing.Point(616, 136).
		this-object:ultraButtonSetFormula:Name = "ultraButtonSetFormula".
		this-object:ultraButtonSetFormula:Size = new System.Drawing.Size(64, 23).
		this-object:ultraButtonSetFormula:TabIndex = 30.
		this-object:ultraButtonSetFormula:Text = "Set".
		this-object:ultraButtonSetFormula:Click:subscribe(this-object:ultraComboEditor_Formula_Click).
		/*  */
		/* ultraComboEditor_Formula */
		/*  */
		valueListItem1:DataValue = "[Price] * [Quantity] * [//SalesTaxRate]".
		valueListItem2:DataValue = "[Summary_Totals()] / [Total]".
		valueListItem3:DataValue = "[Total(-1)]".
		valueListItem4:DataValue = "( [Total(-1)] + [Total] ) / 2".
		valueListItem5:DataValue = "sum( [Total(*)] )".
		valueListItem6:DataValue = "sum( [Total(*)] ) * [//SalesTaxRate]".
		valueListItem7:DataValue = "[Total] + if( iserror( [TestCol(-1)] ), 0, [TestCol(-1)] )".
		valueListItem8:DataValue = "sum( [Total(0)]:[Total] )".
		valueListItem9:DataValue = "average( [Total(0)]:[Total] )".
		@VisualDesigner.FormMember (NeedsInitialize="false", InitializeArray="true").
		define variable arrayvar0 as Infragistics.Win.ValueListItem extent 9 no-undo.
		arrayvar0[1] = valueListItem1.
		arrayvar0[2] = valueListItem2.
		arrayvar0[3] = valueListItem3.
		arrayvar0[4] = valueListItem4.
		arrayvar0[5] = valueListItem5.
		arrayvar0[6] = valueListItem6.
		arrayvar0[7] = valueListItem7.
		arrayvar0[8] = valueListItem8.
		arrayvar0[9] = valueListItem9.
		this-object:ultraComboEditor_Formula:Items:AddRange(arrayvar0).
		this-object:ultraComboEditor_Formula:Location = new System.Drawing.Point(424, 136).
		this-object:ultraComboEditor_Formula:Name = "ultraComboEditor_Formula".
		this-object:ultraComboEditor_Formula:Size = new System.Drawing.Size(184, 21).
		this-object:ultraComboEditor_Formula:SyncWithCurrencyManager = false.
		this-object:ultraComboEditor_Formula:TabIndex = 29.
		this-object:ultraComboEditor_Formula:Click:subscribe(this-object:ultraComboEditor_Formula_Click).
		/*  */
		/* ultraLabel2 */
		/*  */
		this-object:ultraLabel2:Location = new System.Drawing.Point(304, 136).
		this-object:ultraLabel2:Name = "ultraLabel2".
		this-object:ultraLabel2:Size = new System.Drawing.Size(120, 24).
		this-object:ultraLabel2:TabIndex = 28.
		this-object:ultraLabel2:Text = "TestCol Formula:".
		/*  */
		/* ultraLabel1 */
		/*  */
		this-object:ultraLabel1:Location = new System.Drawing.Point(8, 136).
		this-object:ultraLabel1:Name = "ultraLabel1".
		this-object:ultraLabel1:Size = new System.Drawing.Size(100, 23).
		this-object:ultraLabel1:TabIndex = 27.
		this-object:ultraLabel1:Text = "Sales Tax Rate:".
		/*  */
		/* textBox1 */
		/*  */
		this-object:ultraCalcManager1:SetCalcSettings(this-object:textBox1, new Infragistics.Win.UltraWinCalcManager.CalcSettings("SalesTaxRate", ?, ?, "Text", Infragistics.Win.UltraWinCalcManager.CalcErrorIconAlignment:Default, ?)).
		this-object:textBox1:Location = new System.Drawing.Point(112, 136).
		this-object:textBox1:Name = "textBox1".
		this-object:textBox1:Size = new System.Drawing.Size(120, 20).
		this-object:textBox1:TabIndex = 26.
		this-object:textBox1:Text = "8.625".
		/*  */
		/* lblDescription */
		/*  */
		this-object:lblDescription:Anchor = cast(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
		this-object:lblDescription:Location = new System.Drawing.Point(0, 32).
		this-object:lblDescription:Name = "lblDescription".
		this-object:lblDescription:Size = new System.Drawing.Size(704, 96).
		this-object:lblDescription:TabIndex = 25.
		this-object:lblDescription:Text = resources:GetString("lblDescription.Text").
		this-object:lblDescription:UseCompatibleTextRendering = true.
		/*  */
		/* ultraCalcManager1 */
		/*  */
		this-object:ultraCalcManager1:ContainingControl = this-object.
		/*  */
		/* bindingSource1 */
		/*  */
		this-object:bindingSource1:AutoUpdate = true.
		tableDesc1:ChildTables = ?.
		@VisualDesigner.FormMember (NeedsInitialize="false", InitializeArray="true").
		define variable arrayvar1 as Progress.Data.ColumnPropDesc extent 6 no-undo.
		arrayvar1[1] = new Progress.Data.ColumnPropDesc("ItemNum", "Item Num", Progress.Data.DataType:INTEGER).
		arrayvar1[2] = new Progress.Data.ColumnPropDesc("Category1", "Category 1", Progress.Data.DataType:CHARACTER).
		arrayvar1[3] = new Progress.Data.ColumnPropDesc("Category2", "Category 2", Progress.Data.DataType:CHARACTER).
		arrayvar1[4] = new Progress.Data.ColumnPropDesc("Price", "Price", Progress.Data.DataType:DECIMAL).
		arrayvar1[5] = new Progress.Data.ColumnPropDesc("Qty", "Qty", Progress.Data.DataType:INTEGER).
		arrayvar1[6] = new Progress.Data.ColumnPropDesc("Total", "Total", Progress.Data.DataType:DECIMAL).
		tableDesc1:Columns = arrayvar1.
		this-object:bindingSource1:TableSchema = tableDesc1.
		/*  */
		/* UltraGrid1 */
		/*  */
		this-object:UltraGrid1:CalcManager = this-object:ultraCalcManager1.
		this-object:UltraGrid1:Cursor = System.Windows.Forms.Cursors:Default.
		this-object:UltraGrid1:DataSource = this-object:bindingSource1.
		appearance31:BackColor = System.Drawing.Color:White.
		appearance31:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		appearance31:BackGradientStyle = Infragistics.Win.GradientStyle:ForwardDiagonal.
		this-object:UltraGrid1:DisplayLayout:Appearance = appearance31.
		this-object:UltraGrid1:DisplayLayout:AutoFitStyle = Infragistics.Win.UltraWinGrid.AutoFitStyle:ResizeAllColumns.
		ultraGridColumn1:Header:VisiblePosition = 6.
		ultraGridColumn1:Hidden = true.
		ultraGridColumn2:Header:VisiblePosition = 3.
		ultraGridColumn2:Hidden = true.
		ultraGridColumn3:Header:VisiblePosition = 5.
		ultraGridColumn3:Hidden = true.
		appearance1:TextHAlignAsString = "Right".
		ultraGridColumn4:CellAppearance = appearance1.
		ultraGridColumn4:Format = "C".
		ultraGridColumn4:Header:VisiblePosition = 0.
		ultraGridColumn4:RowLayoutColumnInfo:PreferredCellSize = new System.Drawing.Size(100, 0).
		ultraGridColumn4:RowLayoutColumnInfo:PreferredLabelSize = new System.Drawing.Size(100, 0).
		appearance2:TextHAlignAsString = "Right".
		ultraGridColumn5:CellAppearance = appearance2.
		ultraGridColumn5:Format = "".
		ultraGridColumn5:Header:Caption = "Quantity".
		ultraGridColumn5:Header:VisiblePosition = 1.
		ultraGridColumn5:RowLayoutColumnInfo:PreferredCellSize = new System.Drawing.Size(100, 0).
		ultraGridColumn5:RowLayoutColumnInfo:PreferredLabelSize = new System.Drawing.Size(100, 0).
		appearance3:TextHAlignAsString = "Right".
		ultraGridColumn6:CellAppearance = appearance3.
		ultraGridColumn6:Format = "C".
		ultraGridColumn6:Formula = "[Price] *  [Qty]".
		ultraGridColumn6:Header:VisiblePosition = 2.
		ultraGridColumn6:RowLayoutColumnInfo:PreferredCellSize = new System.Drawing.Size(100, 0).
		ultraGridColumn6:RowLayoutColumnInfo:PreferredLabelSize = new System.Drawing.Size(100, 0).
		ultraGridColumn7:Header:VisiblePosition = 4.
		ultraGridColumn7:RowLayoutColumnInfo:PreferredCellSize = new System.Drawing.Size(100, 0).
		ultraGridColumn7:RowLayoutColumnInfo:PreferredLabelSize = new System.Drawing.Size(100, 0).
		@VisualDesigner.FormMember (NeedsInitialize="false", InitializeArray="true").
		define variable arrayvar2 as System.Object extent 7 no-undo.
		arrayvar2[1] = ultraGridColumn1.
		arrayvar2[2] = ultraGridColumn2.
		arrayvar2[3] = ultraGridColumn3.
		arrayvar2[4] = ultraGridColumn4.
		arrayvar2[5] = ultraGridColumn5.
		arrayvar2[6] = ultraGridColumn6.
		arrayvar2[7] = ultraGridColumn7.
		ultraGridBand1:Columns:AddRange(arrayvar2).
		appearance4:FontData:SizeInPoints = 10.
		summarySettings1:Appearance = appearance4.
		summarySettings1:DisplayFormat = "Formulas Summaries:".
		summarySettings1:GroupBySummaryValueAppearance = appearance5.
		appearance6:TextHAlignAsString = "Right".
		summarySettings2:Appearance = appearance6.
		summarySettings2:DisplayFormat = "Grand Total = ~{0:C~}".
		summarySettings2:GroupBySummaryValueAppearance = appearance7.
		appearance8:TextHAlignAsString = "Right".
		summarySettings3:Appearance = appearance8.
		summarySettings3:DisplayFormat = "Sales Tax = ~{0:C~}".
		summarySettings3:GroupBySummaryValueAppearance = appearance9.
		appearance10:TextHAlignAsString = "Right".
		summarySettings4:Appearance = appearance10.
		summarySettings4:DisplayFormat = "Net = ~{0:C~}".
		summarySettings4:GroupBySummaryValueAppearance = appearance11.
		@VisualDesigner.FormMember (NeedsInitialize="false", InitializeArray="true").
		define variable arrayvar3 as Infragistics.Win.UltraWinGrid.SummarySettings extent 4 no-undo.
		arrayvar3[1] = summarySettings1.
		arrayvar3[2] = summarySettings2.
		arrayvar3[3] = summarySettings3.
		arrayvar3[4] = summarySettings4.
		ultraGridBand1:Summaries:AddRange(arrayvar3).
		ultraGridBand1:UseRowLayout = true.
		this-object:UltraGrid1:DisplayLayout:BandsSerializer:Add(ultraGridBand1).
		this-object:UltraGrid1:DisplayLayout:InterBandSpacing = 10.
		appearance43:BackColor = System.Drawing.Color:White.
		this-object:UltraGrid1:DisplayLayout:Override:AddRowAppearance = appearance43.
		this-object:UltraGrid1:DisplayLayout:Override:AllowAddNew = Infragistics.Win.UltraWinGrid.AllowAddNew:TemplateOnBottom.
		appearance44:BackColor = System.Drawing.Color:Transparent.
		this-object:UltraGrid1:DisplayLayout:Override:CardAreaAppearance = appearance44.
		appearance45:BackColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(247)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(247)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(249))).
		appearance45:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		appearance45:BackGradientStyle = Infragistics.Win.GradientStyle:Vertical.
		appearance45:ForeColor = System.Drawing.Color:Black.
		appearance45:TextHAlignAsString = "Left".
		appearance45:ThemedElementAlpha = Infragistics.Win.Alpha:Transparent.
		this-object:UltraGrid1:DisplayLayout:Override:HeaderAppearance = appearance45.
		this-object:UltraGrid1:DisplayLayout:Override:HeaderClickAction = Infragistics.Win.UltraWinGrid.HeaderClickAction:SortMulti.
		appearance46:BorderColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		this-object:UltraGrid1:DisplayLayout:Override:RowAppearance = appearance46.
		appearance47:BackColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(247)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(247)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(249))).
		appearance47:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		appearance47:BackGradientStyle = Infragistics.Win.GradientStyle:Vertical.
		this-object:UltraGrid1:DisplayLayout:Override:RowSelectorAppearance = appearance47.
		this-object:UltraGrid1:DisplayLayout:Override:RowSelectorWidth = 12.
		appearance48:BackColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		appearance48:BackColor2 = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(247)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(247)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(249))).
		appearance48:BackGradientStyle = Infragistics.Win.GradientStyle:Vertical.
		appearance48:ForeColor = System.Drawing.Color:Black.
		this-object:UltraGrid1:DisplayLayout:Override:SelectedRowAppearance = appearance48.
		appearance49:BorderColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		appearance49:FontData:BoldAsString = "True".
		appearance49:ForeColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		this-object:UltraGrid1:DisplayLayout:Override:SummaryFooterAppearance = appearance49.
		appearance50:FontData:SizeInPoints = 10.
		appearance50:TextHAlignAsString = "Right".
		this-object:UltraGrid1:DisplayLayout:Override:SummaryFooterCaptionAppearance = appearance50.
		this-object:UltraGrid1:DisplayLayout:Override:SummaryFooterCaptionVisible = Infragistics.Win.DefaultableBoolean:False.
		appearance51:BackColor = System.Drawing.Color:White.
		appearance51:ForeColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(98)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(97)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(121))).
		this-object:UltraGrid1:DisplayLayout:Override:SummaryValueAppearance = appearance51.
		appearance52:BackColor = System.Drawing.Color:White.
		this-object:UltraGrid1:DisplayLayout:Override:TemplateAddRowAppearance = appearance52.
		this-object:UltraGrid1:DisplayLayout:RowConnectorColor = System.Drawing.Color:FromArgb(Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(168)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(167)), Progress.Util.CastUtil:ToInt32(Progress.Util.CastUtil:ToByte(191))).
		this-object:UltraGrid1:DisplayLayout:RowConnectorStyle = Infragistics.Win.UltraWinGrid.RowConnectorStyle:Solid.
		rowScrollRegion1:ScrollPosition = 0.
		rowScrollRegion2:ScrollPosition = 0.
		rowScrollRegion3:ScrollPosition = 0.
		this-object:UltraGrid1:DisplayLayout:RowScrollRegions:Add(rowScrollRegion1).
		this-object:UltraGrid1:DisplayLayout:RowScrollRegions:Add(rowScrollRegion2).
		this-object:UltraGrid1:DisplayLayout:RowScrollRegions:Add(rowScrollRegion3).
		this-object:UltraGrid1:DisplayLayout:ScrollBounds = Infragistics.Win.UltraWinGrid.ScrollBounds:ScrollToFill.
		this-object:UltraGrid1:DisplayLayout:ScrollStyle = Infragistics.Win.UltraWinGrid.ScrollStyle:Immediate.
		this-object:UltraGrid1:Dock = System.Windows.Forms.DockStyle:Bottom.
		this-object:UltraGrid1:Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25, System.Drawing.FontStyle:Regular, System.Drawing.GraphicsUnit:Point, Progress.Util.CastUtil:ToByte(0)).
		this-object:UltraGrid1:Location = new System.Drawing.Point(0, 166).
		this-object:UltraGrid1:Name = "UltraGrid1".
		this-object:UltraGrid1:Size = new System.Drawing.Size(704, 336).
		this-object:UltraGrid1:TabIndex = 31.
		this-object:UltraGrid1:InitializeLayout:subscribe(this-object:UltraGrid1_InitializeLayout).
		this-object:UltraGrid1:MouseLeaveElement:subscribe(this-object:UltraGrid1_MouseLeaveElement).
		this-object:UltraGrid1:MouseEnterElement:subscribe(this-object:UltraGrid1_MouseEnterElement).
		/*  */
		/* frmFormulas */
		/*  */
		this-object:ClientSize = new System.Drawing.Size(704, 502).
		this-object:Controls:Add(this-object:UltraGrid1).
		this-object:Controls:Add(this-object:ultraButtonSetFormula).
		this-object:Controls:Add(this-object:ultraComboEditor_Formula).
		this-object:Controls:Add(this-object:ultraLabel2).
		this-object:Controls:Add(this-object:ultraLabel1).
		this-object:Controls:Add(this-object:textBox1).
		this-object:Controls:Add(this-object:lblDescription).
		this-object:Controls:Add(this-object:Panel1).
		this-object:Name = "frmFormulas".
		this-object:Text = "Formulas".
		this-object:Load:subscribe(this-object:frmFormulas_Load).
		this-object:FormClosing:subscribe(this-object:frmFormulas_FormClosing).
		this-object:Panel1:ResumeLayout(false).
		cast(this-object:ultraComboEditor_Formula, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraCalcManager1, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:bindingSource1, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:UltraGrid1, System.ComponentModel.ISupportInitialize):EndInit().
		this-object:ResumeLayout(false).
		this-object:PerformLayout().
	end method.

    method protected Progress.Data.BindingSource GetCategoryItemSource():   
        if not valid-object(CategoryItemService) then
        do:
            CategoryItemService = new DataServices.CategoryItemService(10).                  
            CategoryItemService:fetchData().                                                 
        end.
        return new Progress.Data.BindingSource(CategoryItemService:DataSetHandle).
    end method. 
    
    /* implements ISamplesBase interface  */
    method public void ShowMe( owner as System.Windows.Forms.Form  ):
         if (owner <> ?) then
			this-object:Owner = owner. 
		this-object:Show().
	    this-object:CancelButton = btnTitle.
        this-object:CenterToScreen().
		this-object:MaximizeBox = true.
	end.	

    /* implements ISamplesBase interface  */
    method public void HideMe( ):
        this-object:Hide().   
    end.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID btnTitle_MouseUp( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.MouseEventArgs ):
		if valid-object(this-object:Owner) then
		    (cast (this-object:Owner,frmMain)):Navigation(e:Button).
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmFormulas_FormClosing( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.FormClosingEventArgs ):
		if valid-object(this-object:Owner) then 
	    do:
	        e:Cancel = true.
		    this-object:Visible = false.
		end.
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmFormulas_Load( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		
		UltraGrid1:DataSource = GetCategoryItemSource() no-error.	
		RETURN.
	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID UltraGrid1_InitializeLayout( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs ):
		RETURN.

	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID UltraGrid1_MouseEnterElement( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UIElementEventArgs ):
		define variable formula as character no-undo.
		define variable cell as UltraGridCell  no-undo.
		define variable summaryValue as SummaryValue no-undo.
	 
		if type-of(e:Element,CellUIElement) then
        do:
            cell = cast(e:Element:GetContext( TypeHelper:GetType("Infragistics.Win.UltraWinGrid.UltraGridCell")),UltraGridCell).
		    formula = cell:Column:Formula.
			if formula > "" then
				formula = cell:Column:Key + " = " + formula.
		 
			else if type-of(e:Element,SummaryValueUIElement) then
			do: 
				summaryValue = cast(e:Element:GetContext( TypeHelper:GetType("Infragistics.Win.UltraWinGrid.SummaryValue")),SummaryValue).
				formula = summaryValue:SummarySettings:Formula.
				if formula > "" then
					formula = summaryValue:Key + "() = " + formula.
			 
			end.
			if formula > "" then
			do: 
				this-object:ToolTip:Hide( ).
				this-object:ToolTip:ToolTipText = formula.
				this-object:ToolTip:Show( UltraGrid1:RectangleToScreen( e:Element:Rect ), 
					0, true, true, true, Rectangle:Empty, false, false ).
			end. 
		end.
		RETURN.

	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID UltraGrid1_MouseLeaveElement( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UIElementEventArgs ):
		if type-of(e:Element,CellUIElement) or type-of(e:Element,SummaryValueUIElement) then
			this-object:ToolTip:Hide( ).
		RETURN.

	END METHOD.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraComboEditor_Formula_Click( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		define variable formula as character no-undo.
		formula = ultraComboEditor_Formula:Text.
        UltraGrid1:DisplayLayout:Bands[0]:Columns["TestCol"]:Formula = formula.
	
		RETURN.

	END METHOD.

	DESTRUCTOR PUBLIC frmFormulas ( ):
		IF VALID-OBJECT(components) THEN DO:
			CAST(components, System.IDisposable):Dispose().
		END.
	END DESTRUCTOR.

END CLASS.