/* 
ABL example derived from Infragistics source, copyright ©1992-2008 Infragistics, 
Inc., Windsor Corporate Park, 50 Millstone Road, Building 200 Suite 150, East 
Windsor, NJ 08520. All rights reserved.
*/ 
 /*------------------------------------------------------------------------
    File        : AppearancePicker
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : hdaniels
    Created     : Sat May 24 19:31:18 EDT 2008
    Notes       : 
  ----------------------------------------------------------------------*/

USING Progress.Lang.*. 
USING Progress.Windows.Form.
 
CLASS WinGrid.SamplesExplorer.AppearancePicker INHERITS Form   : 
	
	DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer.


	define public variable propertyGrid as System.Windows.Forms.PropertyGrid no-undo.
	define public variable cmdOK as System.Windows.Forms.Button no-undo.

		
	CONSTRUCTOR PUBLIC AppearancePicker (  ):
		
		SUPER().
		InitializeComponent ( ).

	END CONSTRUCTOR.

	DESTRUCTOR PUBLIC AppearancePicker ( ):

		IF VALID-OBJECT(components) THEN DO:
			CAST(components, System.IDisposable):Dispose().
		END.

	END DESTRUCTOR.

	method private void InitializeComponent ( ):

/* 		NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

		We strongly suggest that the contents of this method only be modified using the
		Visual Designer to avoid any incompatible modifications.

		Modifying the contents of this method using a code editor will invalidate any support for this file. */

		this-object:propertyGrid = new System.Windows.Forms.PropertyGrid().
		this-object:cmdOK = new System.Windows.Forms.Button().
		this-object:SuspendLayout().
		/*  */
		/* propertyGrid */
		/*  */
		this-object:propertyGrid:Dock = System.Windows.Forms.DockStyle:Top.
		this-object:propertyGrid:LineColor = System.Drawing.SystemColors:ScrollBar.
		this-object:propertyGrid:Location = new System.Drawing.Point(0, 0).
		this-object:propertyGrid:Name = "propertyGrid".
		this-object:propertyGrid:Size = new System.Drawing.Size(376, 360).
		this-object:propertyGrid:TabIndex = 5.
		this-object:propertyGrid:UseCompatibleTextRendering = true.
		/*  */
		/* cmdOK */
		/*  */
		this-object:cmdOK:DialogResult = System.Windows.Forms.DialogResult:OK.
		this-object:cmdOK:Location = new System.Drawing.Point(144, 368).
		this-object:cmdOK:Name = "cmdOK".
		this-object:cmdOK:Size = new System.Drawing.Size(75, 23).
		this-object:cmdOK:TabIndex = 6.
		this-object:cmdOK:Text = "OK".
		this-object:cmdOK:UseCompatibleTextRendering = true.
		this-object:cmdOK:Click:subscribe(this-object:cmdOK_Click).
		/*  */
		/* frmAppearancePicker */
		/*  */
		this-object:ClientSize = new System.Drawing.Size(376, 397).
		this-object:Controls:Add(this-object:cmdOK).
		this-object:Controls:Add(this-object:propertyGrid).
		this-object:Name = "frmAppearancePicker".
		this-object:Text = "AppearancePicker".
		this-object:Load:subscribe(this-object:frmAppearancePicker_Load).
		this-object:Resize:subscribe(this-object:frmAppearancePicker_Resize).
		this-object:ResumeLayout(false).

	end method.
    
    method public void ShowMe(objAppearance as System.Object, strCaption as char ):
	    propertyGrid:SelectedObject = objAppearance.
        this-object:Text = "Appearance properties - " + strCaption.
        this-object:Show().
	end method.
	
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID cmdOK_Click( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		this-object:Hide().
		RETURN.

	END METHOD.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmAppearancePicker_Load( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		this-object:TopMost = true.
		RETURN.

	END METHOD.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmAppearancePicker_Resize( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		define variable leftPos   as integer no-undo.
		define variable topPos    as integer no-undo.
		define variable gridHeight as integer no-undo.
		
		assign
		    leftPos = (this-object:Size:Width / 2) - (cmdOK:Size:Width / 2)
			topPos   = this-object:ClientSize:Height - (cmdOK:Size:Height + 10).
		cmdOK:SetBounds(leftPos, topPos, cmdOK:Size:Width, cmdOK:Size:Height).

		gridHeight = this-object:ClientSize:Height - cmdOK:Size:Height - 20.
		propertyGrid:SetBounds(propertyGrid:Location:X, propertyGrid:Location:Y, propertyGrid:Size:Width, height).
		
		RETURN.

	END METHOD.
  
END CLASS.