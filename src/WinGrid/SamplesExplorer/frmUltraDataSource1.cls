/* 
ABL example derived from Infragistics source, copyright ©1992-2008 Infragistics, 
Inc., Windsor Corporate Park, 50 Millstone Road, Building 200 Suite 150, East 
Windsor, NJ 08520. All rights reserved.
*/ 
 /*------------------------------------------------------------------------
    File        : frmUltraDataSource1
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : hdaniels - copied/transformed from Infragistic sample
    Created     : Sun Jun 01 16:49:13 EDT 2008
    Notes       : 
  ----------------------------------------------------------------------*/

USING Progress.Lang.*.
USING Progress.Windows.Form.

using WinGrid.SamplesExplorer.*.

CLASS WinGrid.SamplesExplorer.frmUltraDataSource1 INHERITS Form implements ISamplesBase : 
	
	DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer.


	define private variable UltraGrid1 as Infragistics.Win.UltraWinGrid.UltraGrid no-undo.
	define public variable lblDescription as System.Windows.Forms.Label no-undo.
	define public variable btnTitle as System.Windows.Forms.Button no-undo.
    
	/* Provides a description for the sample. */
	define public property Description as character no-undo 
	get:
	    return lblDescription:Text.
	end.
	
    /* Name of the sample. */
	define public property SampleName as character no-undo
    get:
        return btnTitle:Text. 
    end.
	
    /* Type of sample. */
	define public property SampleType as character no-undo
	get:
	    return "Feature".
	end.    

	/* Preview Picture for Sample */
	define public property PreviewPicture as System.Drawing.Image no-undo
    get:
        return System.Drawing.Image:FromFile(SamplesPath:GraphicsPath + "/Previews/UltraDataSource1.png").
    end.  
			
	define public variable ultraDataSource1 as Infragistics.Win.UltraWinDataSource.UltraDataSource no-undo.

	CONSTRUCTOR PUBLIC frmUltraDataSource1 (  ):
		
		SUPER().
		InitializeComponent ( ).

	END CONSTRUCTOR.

	DESTRUCTOR PUBLIC frmUltraDataSource1 ( ):

		IF VALID-OBJECT(components) THEN DO:
			CAST(components, System.IDisposable):Dispose().
		END.

	END DESTRUCTOR.

	method private void InitializeComponent ( ):

/* 		NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

		We strongly suggest that the contents of this method only be modified using the
		Visual Designer to avoid any incompatible modifications.

		Modifying the contents of this method using a code editor will invalidate any support for this file. */

		this-object:components = new System.ComponentModel.Container().
		this-object:lblDescription = new System.Windows.Forms.Label().
		this-object:btnTitle = new System.Windows.Forms.Button().
		this-object:UltraGrid1 = new Infragistics.Win.UltraWinGrid.UltraGrid().
		this-object:ultraDataSource1 = new Infragistics.Win.UltraWinDataSource.UltraDataSource(this-object:components).
		cast(this-object:UltraGrid1, System.ComponentModel.ISupportInitialize):BeginInit().
		cast(this-object:ultraDataSource1, System.ComponentModel.ISupportInitialize):BeginInit().
		this-object:SuspendLayout().
		/*  */
		/* lblDescription */
		/*  */
		this-object:lblDescription:Anchor = cast(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
		this-object:lblDescription:Location = new System.Drawing.Point(0, 35).
		this-object:lblDescription:Name = "lblDescription".
		this-object:lblDescription:Size = new System.Drawing.Size(704, 24).
		this-object:lblDescription:TabIndex = 20.
		this-object:lblDescription:Text = "This sample demonstrates the UltraDataSource component in virtual mode. It demonstrates the concept with minimal amount of code.".
		this-object:lblDescription:UseCompatibleTextRendering = true.
		/*  */
		/* btnTitle */
		/*  */
		this-object:btnTitle:Dock = System.Windows.Forms.DockStyle:Top.
		this-object:btnTitle:FlatStyle = System.Windows.Forms.FlatStyle:Flat.
		this-object:btnTitle:Font = new System.Drawing.Font("Arial", 14.25, System.Drawing.FontStyle:Bold, System.Drawing.GraphicsUnit:Point, Progress.Util.CastUtil:ToByte(0)).
		this-object:btnTitle:Location = new System.Drawing.Point(0, 0).
		this-object:btnTitle:Name = "btnTitle".
		this-object:btnTitle:Size = new System.Drawing.Size(704, 32).
		this-object:btnTitle:TabIndex = 19.
		this-object:btnTitle:Text = "Virtual Mode (1 Millon Rows !)".
		this-object:btnTitle:TextAlign = System.Drawing.ContentAlignment:MiddleLeft.
		this-object:btnTitle:UseCompatibleTextRendering = true.
		this-object:btnTitle:MouseUp:subscribe(this-object:btnTitle_MouseUp).
		/*  */
		/* UltraGrid1 */
		/*  */
		this-object:UltraGrid1:Anchor = cast(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Bottom), System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
		this-object:UltraGrid1:Location = new System.Drawing.Point(0, 59).
		this-object:UltraGrid1:Name = "UltraGrid1".
		this-object:UltraGrid1:Size = new System.Drawing.Size(704, 440).
		this-object:UltraGrid1:TabIndex = 21.
		this-object:UltraGrid1:InitializeLayout:subscribe(this-object:UltraGrid1_InitializeLayout).
		/*  */
		/* ultraDataSource1 */
		/*  */
		this-object:ultraDataSource1:CellDataRequested:subscribe(this-object:ultraDataSource1_CellDataRequested).
		/*  */
		/* frmUltraDataSource1 */
		/*  */
		this-object:ClientSize = new System.Drawing.Size(704, 502).
		this-object:Controls:Add(this-object:UltraGrid1).
		this-object:Controls:Add(this-object:lblDescription).
		this-object:Controls:Add(this-object:btnTitle).
		this-object:Name = "frmUltraDataSource1".
		this-object:Text = "UltraDataSource1".
		this-object:Load:subscribe(this-object:frmUltraDataSource1_Load).
		this-object:FormClosing:subscribe(this-object:frmUltraDataSource1_FormClosing).
		cast(this-object:UltraGrid1, System.ComponentModel.ISupportInitialize):EndInit().
		cast(this-object:ultraDataSource1, System.ComponentModel.ISupportInitialize):EndInit().
		this-object:ResumeLayout(false).

	end method.


    /* implements ISamplesBase interface  */
    method public void ShowMe( owner as System.Windows.Forms.Form  ):
/*		InitializeForm().*/
	    if (owner <> ?) then
			this-object:Owner = owner.
		this-object:Show().
	    this-object:CancelButton = btnTitle.
        this-object:CenterToScreen().
		this-object:MaximizeBox = true.
	end method.	

    /* implements ISamplesBase interface. */
    method public void HideMe( ):
        this-object:Hide().   
    end.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID UltraGrid1_InitializeLayout( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs ):
		/* Set the scroll style to immediate so the rows get scrolled immediately */
		/* when the vertical scrollbar thumb is dragged. */
		 
		e:Layout:ScrollStyle = Infragistics.Win.UltraWinGrid.ScrollStyle:Immediate.

		/* ScrollBounds of ScrollToFill will prevent the user from scrolling the */
		/* grid further down once the last row becomes fully visible. */
		 
		e:Layout:ScrollBounds = Infragistics.Win.UltraWinGrid.ScrollBounds:ScrollToFill.
		RETURN.

	END METHOD.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID btnTitle_MouseUp( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.MouseEventArgs ):
		if valid-object(this-object:Owner) then
		    (cast (this-object:Owner,frmMain)):Navigation(e:Button).
		RETURN.

	END METHOD.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID ultraDataSource1_CellDataRequested( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UltraWinDataSource.CellDataRequestedEventArgs ):
		if e:Column:Index = 0 then
		do:
			/* 0th column is the Index column. This is how we added columns in */
			/* when we setup the data source. */
			e:Data = e:Row:Index.
		end.
		else /* Other columns */
			e:Data = string(e:Row:Index) + ", " + string(e:Column:Index).
			

		/* By default UltraDataSource will cache the provided cell value and not ask for */
		/* it next time it's needed. Set CacheData to false to prevent UltraDataSource */
		/* from doing so. */
		e:CacheData = false.
		RETURN.

	END METHOD.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmUltraDataSource1_Load( INPUT sender AS System.Object, INPUT e AS System.EventArgs ):
		define variable i as integer no-undo.
		
		ultraDataSource1:Band:Columns:Clear( ).
		ultraDataSource1:Band:Columns:Add( "Index", Progress.Util.TypeHelper:GetType("System.Int")).
		do i = 0 to 9:
			ultraDataSource1:Band:Columns:Add( "Col" + string(i), Progress.Util.TypeHelper:GetType("System.String")).
        end.

		/* Set the row count: This is how many rows we will have: */
		ultraDataSource1:Rows:SetCount( 1000000 ).

		/* Disable any data modifications: */
		ultraDataSource1:AllowAdd = false.
		ultraDataSource1:AllowDelete = false.
		ultraDataSource1:ReadOnly = true.

		/* Set the LoadStyle to LoadOnDemand so the UltraGrid doesn't pre-load */ 
		/* all the rows: LoadOnDemand load style creates rows as they are needed */
		/* (for example when they are scrolled into view): You must do this */
		/* before setting the DataSource on the UltraGrid: */
		 
		UltraGrid1:DisplayLayout:LoadStyle = Infragistics.Win.UltraWinGrid.LoadStyle:LoadOnDemand.
		UltraGrid1:DataSource = ultraDataSource1.

		/* Disable sorting: If not disabled, when the user sorts rows, UltraGrid */
		/* will create all the rows: */
		UltraGrid1:DisplayLayout:Override:HeaderClickAction = Infragistics.Win.UltraWinGrid.HeaderClickAction:Select.
		RETURN.

	END METHOD.
	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	@VisualDesigner.
	METHOD PRIVATE VOID frmUltraDataSource1_FormClosing( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.FormClosingEventArgs ):
		if valid-object(this-object:Owner) then 
	    do:
	        e:Cancel = true.
		    this-object:Visible = false.
		end.
		RETURN.

	END METHOD.


 

 

 
 
END CLASS.