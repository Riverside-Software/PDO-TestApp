 /*------------------------------------------------------------------------
    File        : Form1
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : mferrant
    Created     : Tue May 13 10:30:54 EDT 2008
    Notes       : 
  ----------------------------------------------------------------------*/

USING Progress.Lang.*.
USING Progress.Windows.Form.

USING Infragistics.Win.*.
USING Infragistics.Win.UltraWinGrid.*.
USING Infragistics.Win.UltraWinGrid.*.
USING Infragistics.Win.UltraWinMaskedEdit.*.
USING Infragistics.Win.UltraWinProgressBar.*.

CLASS WinEditors.EmbeddableEditorsInColumns.Form1 INHERITS Form   : 

	DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer.


	DEFINE PRIVATE VARIABLE chkSupportThemes AS System.Windows.Forms.CheckBox NO-UNDO.
	DEFINE PRIVATE VARIABLE lblDisplayStyle AS System.Windows.Forms.Label NO-UNDO.
	DEFINE PRIVATE VARIABLE cboDisplayStyle AS System.Windows.Forms.ComboBox NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraGrid1 AS Infragistics.Win.UltraWinGrid.UltraGrid NO-UNDO.


	DEFINE PRIVATE VARIABLE ultraCalculatorDropDown1 AS Infragistics.Win.UltraWinEditors.UltraWinCalc.UltraCalculatorDropDown NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraComboEditor1 AS Infragistics.Win.UltraWinEditors.UltraComboEditor NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraCurrencyEditor1 AS Infragistics.Win.UltraWinEditors.UltraCurrencyEditor NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraDateTimeEditor1 AS Infragistics.Win.UltraWinEditors.UltraDateTimeEditor NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraOptionSet1 AS Infragistics.Win.UltraWinEditors.UltraOptionSet NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraTextEditor1 AS Infragistics.Win.UltraWinEditors.UltraTextEditor NO-UNDO.
	DEFINE PRIVATE VARIABLE ultraNumericEditor1 AS Infragistics.Win.UltraWinEditors.UltraNumericEditor NO-UNDO.

    DEFINE PRIVATE VARIABLE tblTypes   AS System.Data.DataTable NO-UNDO.
    DEFINE PRIVATE PROPERTY TypesTable AS System.Data.DataTable NO-UNDO
	GET:
	    DEFINE VARIABLE record AS System.Array NO-UNDO.

	    IF tblTypes = ? THEN
		DO:
		    record = System.Array:CreateInstance(Progress.Util.TypeHelper:GetType("System.Object"), 9).

		    /*Create Table*/
			tblTypes = new System.Data.DataTable("tblTypes":U).
			tblTypes:COLUMNS:Add("Numeric",Progress.util.TypeHelper:GetType("System.Int32":U)).
			tblTypes:COLUMNS:Add("Currency",Progress.util.TypeHelper:GetType("System.Decimal":U)).
			tblTypes:COLUMNS:Add("CalculatorDropDown",Progress.util.TypeHelper:GetType("System.Decimal":U)).

			tblTypes:Columns:Add("OptionSet",Progress.util.TypeHelper:GetType("System.Int32":U)).
			tblTypes:Columns:Add("Combo",Progress.util.TypeHelper:GetType("System.Int32":U)).

			tblTypes:Columns:Add("DatePicker",Progress.util.TypeHelper:GetType("System.DateTime":U)).
			tblTypes:Columns:Add("Text",Progress.util.TypeHelper:GetType("System.String":U)).

			tblTypes:Columns:Add("Check",Progress.util.TypeHelper:GetType("System.Boolean":U)).
			tblTypes:Columns:Add("Progress",Progress.util.TypeHelper:GetType("System.Int32":U)).

            record:SetValue(0,0).
            record:SetValue(12,1).
            record:SetValue(0,2).
            record:Setvalue(0,3).
            record:Setvalue(0,4).
            record:SetValue(now,5).
            record:SetValue("Text",6).
            record:SetValue(true,7).
            record:SetValue(50,8).
			tblTypes:Rows:Add(CAST(record, "System.Object[]")).

			record:SetValue(2,0).
            record:SetValue(234.34,1).
            record:SetValue(0,2).
            record:Setvalue(0,3).
            record:Setvalue(1,4).
            record:SetValue(now,5).
            record:SetValue("Text",6).
            record:SetValue(false,7).
            record:SetValue(75,8).
			tblTypes:Rows:Add(CAST(record, "System.Object[]")).

			record:SetValue(4,0).
            record:SetValue(53.22,1).
            record:SetValue(0,2).
            record:Setvalue(0,3).
            record:Setvalue(2,4).
            record:SetValue(now,5).
            record:SetValue("Text",6).
            record:SetValue(true,7).
            record:SetValue(20,8).
			tblTypes:Rows:Add(CAST(record, "System.Object[]")).
        END. /*IF tblTypes = ? THEN*/
        RETURN tblTypes.
	END. /*GET of TypesTable property*/

	CONSTRUCTOR PUBLIC Form1 (  ):

		SUPER().
		InitializeComponent ( ).

	END CONSTRUCTOR.

	DESTRUCTOR PUBLIC Form1 ( ):

		IF VALID-OBJECT(components) THEN DO:
			CAST(components, System.IDisposable):Dispose().
		END.

	END DESTRUCTOR.

	METHOD PRIVATE VOID InitializeComponent ( ):

/* 		NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

		We strongly suggest that the contents of this method only be modified using the
		Visual Designer to avoid any incompatible modifications.

		Modifying the contents of this method using a code editor will invalidate any support for this file. */

		@VisualDesigner.FormMember (NeedsInitialize="true").
		DEFINE VARIABLE valueListItem1 AS Infragistics.Win.ValueListItem NO-UNDO.
		valueListItem1 = NEW Infragistics.Win.ValueListItem().
		THIS-OBJECT:chkSupportThemes = NEW System.Windows.Forms.CheckBox().
		THIS-OBJECT:lblDisplayStyle = NEW System.Windows.Forms.Label().
		THIS-OBJECT:cboDisplayStyle = NEW System.Windows.Forms.ComboBox().
		THIS-OBJECT:ultraGrid1 = NEW Infragistics.Win.UltraWinGrid.UltraGrid().
		THIS-OBJECT:ultraCalculatorDropDown1 = NEW Infragistics.Win.UltraWinEditors.UltraWinCalc.UltraCalculatorDropDown().
		THIS-OBJECT:ultraComboEditor1 = NEW Infragistics.Win.UltraWinEditors.UltraComboEditor().
		THIS-OBJECT:ultraCurrencyEditor1 = NEW Infragistics.Win.UltraWinEditors.UltraCurrencyEditor().
		THIS-OBJECT:ultraDateTimeEditor1 = NEW Infragistics.Win.UltraWinEditors.UltraDateTimeEditor().
		THIS-OBJECT:ultraOptionSet1 = NEW Infragistics.Win.UltraWinEditors.UltraOptionSet().
		THIS-OBJECT:ultraTextEditor1 = NEW Infragistics.Win.UltraWinEditors.UltraTextEditor().
		THIS-OBJECT:ultraNumericEditor1 = NEW Infragistics.Win.UltraWinEditors.UltraNumericEditor().
		CAST(THIS-OBJECT:ultraGrid1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraCalculatorDropDown1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraComboEditor1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraCurrencyEditor1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraDateTimeEditor1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraOptionSet1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraTextEditor1, System.ComponentModel.ISupportInitialize):BeginInit().
		CAST(THIS-OBJECT:ultraNumericEditor1, System.ComponentModel.ISupportInitialize):BeginInit().
		THIS-OBJECT:SuspendLayout().
		/*  */
		/* chkSupportThemes */
		/*  */
		THIS-OBJECT:chkSupportThemes:Location = NEW System.Drawing.Point(238, 253).
		THIS-OBJECT:chkSupportThemes:Name = "chkSupportThemes".
		THIS-OBJECT:chkSupportThemes:Size = NEW System.Drawing.Size(104, 24).
		THIS-OBJECT:chkSupportThemes:TabIndex = 16.
		THIS-OBJECT:chkSupportThemes:Text = "SupportThemes".
		THIS-OBJECT:chkSupportThemes:UseCompatibleTextRendering = TRUE.
		THIS-OBJECT:chkSupportThemes:CheckedChanged:SUBSCRIBE(THIS-OBJECT:chkSupportThemes_CheckedChanged).
		/*  */
		/* lblDisplayStyle */
		/*  */
		THIS-OBJECT:lblDisplayStyle:AutoSize = TRUE.
		THIS-OBJECT:lblDisplayStyle:Location = NEW System.Drawing.Point(14, 259).
		THIS-OBJECT:lblDisplayStyle:Name = "lblDisplayStyle".
		THIS-OBJECT:lblDisplayStyle:Size = NEW System.Drawing.Size(67, 17).
		THIS-OBJECT:lblDisplayStyle:TabIndex = 15.
		THIS-OBJECT:lblDisplayStyle:Text = "DisplayStyle".
		THIS-OBJECT:lblDisplayStyle:UseCompatibleTextRendering = TRUE.
		/*  */
		/* cboDisplayStyle */
		/*  */
		THIS-OBJECT:cboDisplayStyle:Location = NEW System.Drawing.Point(86, 255).
		THIS-OBJECT:cboDisplayStyle:Name = "cboDisplayStyle".
		THIS-OBJECT:cboDisplayStyle:Size = NEW System.Drawing.Size(128, 21).
		THIS-OBJECT:cboDisplayStyle:TabIndex = 14.
		THIS-OBJECT:cboDisplayStyle:Text = "DisplayStyle".
		THIS-OBJECT:cboDisplayStyle:SelectedIndexChanged:SUBSCRIBE(THIS-OBJECT:cboDisplayStyle_SelectedIndexChanged).
		/*  */
		/* ultraGrid1 */
		/*  */
		THIS-OBJECT:ultraGrid1:Anchor = CAST(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Bottom), System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
		THIS-OBJECT:ultraGrid1:Location = NEW System.Drawing.Point(12, 17).
		THIS-OBJECT:ultraGrid1:Name = "ultraGrid1".
		THIS-OBJECT:ultraGrid1:Size = NEW System.Drawing.Size(736, 232).
		THIS-OBJECT:ultraGrid1:TabIndex = 17.
		THIS-OBJECT:ultraGrid1:Text = "Embeddable Editors in Grid Columns".
		/*  */
		/* ultraCalculatorDropDown1 */
		/*  */
		THIS-OBJECT:ultraCalculatorDropDown1:Location = NEW System.Drawing.Point(406, 398).
		THIS-OBJECT:ultraCalculatorDropDown1:Name = "ultraCalculatorDropDown1".
		THIS-OBJECT:ultraCalculatorDropDown1:Size = NEW System.Drawing.Size(64, 21).
		THIS-OBJECT:ultraCalculatorDropDown1:TabIndex = 24.
		THIS-OBJECT:ultraCalculatorDropDown1:Text = "ultraCalculatorDropDown1".
		/*  */
		/* ultraComboEditor1 */
		/*  */
		THIS-OBJECT:ultraComboEditor1:Location = NEW System.Drawing.Point(526, 374).
		THIS-OBJECT:ultraComboEditor1:Name = "ultraComboEditor1".
		THIS-OBJECT:ultraComboEditor1:Size = NEW System.Drawing.Size(80, 21).
		THIS-OBJECT:ultraComboEditor1:SyncWithCurrencyManager = FALSE.
		THIS-OBJECT:ultraComboEditor1:TabIndex = 23.
		THIS-OBJECT:ultraComboEditor1:Text = "ultraComboEditor1".
		/*  */
		/* ultraCurrencyEditor1 */
		/*  */
		THIS-OBJECT:ultraCurrencyEditor1:Location = NEW System.Drawing.Point(406, 374).
		THIS-OBJECT:ultraCurrencyEditor1:MaskInput = "".
		THIS-OBJECT:ultraCurrencyEditor1:Name = "ultraCurrencyEditor1".
		THIS-OBJECT:ultraCurrencyEditor1:Size = NEW System.Drawing.Size(96, 21).
		THIS-OBJECT:ultraCurrencyEditor1:TabIndex = 22.
		/*  */
		/* ultraDateTimeEditor1 */
		/*  */
		THIS-OBJECT:ultraDateTimeEditor1:Location = NEW System.Drawing.Point(638, 350).
		THIS-OBJECT:ultraDateTimeEditor1:MaskDisplayMode = Infragistics.Win.UltraWinMaskedEdit.MaskMode:IncludeLiterals.
		THIS-OBJECT:ultraDateTimeEditor1:Name = "ultraDateTimeEditor1".
		THIS-OBJECT:ultraDateTimeEditor1:Size = NEW System.Drawing.Size(104, 21).
		THIS-OBJECT:ultraDateTimeEditor1:SpinButtonDisplayStyle = Infragistics.Win.ButtonDisplayStyle:OnMouseEnter.
		THIS-OBJECT:ultraDateTimeEditor1:TabIndex = 21.
		/*  */
		/* ultraOptionSet1 */
		/*  */
		THIS-OBJECT:ultraOptionSet1:BorderStyle = Infragistics.Win.UIElementBorderStyle:None.
		valueListItem1:DataValue = "Default Item".
		valueListItem1:DisplayText = "Default Item".
		@VisualDesigner.FormMember (NeedsInitialize="false", InitializeArray="true").
		DEFINE VARIABLE arrayvar0 AS Infragistics.Win.ValueListItem EXTENT 1 NO-UNDO.
		arrayvar0[1] = valueListItem1.
		THIS-OBJECT:ultraOptionSet1:Items:AddRange(arrayvar0).
		THIS-OBJECT:ultraOptionSet1:Location = NEW System.Drawing.Point(518, 350).
		THIS-OBJECT:ultraOptionSet1:Name = "ultraOptionSet1".
		THIS-OBJECT:ultraOptionSet1:Size = NEW System.Drawing.Size(96, 24).
		THIS-OBJECT:ultraOptionSet1:TabIndex = 20.
		/*  */
		/* ultraTextEditor1 */
		/*  */
		THIS-OBJECT:ultraTextEditor1:Location = NEW System.Drawing.Point(638, 382).
		THIS-OBJECT:ultraTextEditor1:Name = "ultraTextEditor1".
		THIS-OBJECT:ultraTextEditor1:Size = NEW System.Drawing.Size(88, 21).
		THIS-OBJECT:ultraTextEditor1:TabIndex = 19.
		THIS-OBJECT:ultraTextEditor1:Text = "ultraTextEditor1".
		/*  */
		/* ultraNumericEditor1 */
		/*  */
		THIS-OBJECT:ultraNumericEditor1:Location = NEW System.Drawing.Point(406, 350).
		THIS-OBJECT:ultraNumericEditor1:Name = "ultraNumericEditor1".
		THIS-OBJECT:ultraNumericEditor1:Size = NEW System.Drawing.Size(96, 21).
		THIS-OBJECT:ultraNumericEditor1:TabIndex = 18.
		/*  */
		/* Form1 */
		/*  */
		THIS-OBJECT:ClientSize = NEW System.Drawing.Size(760, 279).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraCalculatorDropDown1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraComboEditor1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraCurrencyEditor1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraDateTimeEditor1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraOptionSet1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraTextEditor1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraNumericEditor1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraGrid1).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:chkSupportThemes).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:lblDisplayStyle).
		THIS-OBJECT:Controls:Add(THIS-OBJECT:cboDisplayStyle).
		THIS-OBJECT:Name = "Form1".
		THIS-OBJECT:Text = "Embeddable Editors in Grid Columns".
		THIS-OBJECT:Load:SUBSCRIBE(THIS-OBJECT:Form1_Load).
		CAST(THIS-OBJECT:ultraGrid1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraCalculatorDropDown1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraComboEditor1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraCurrencyEditor1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraDateTimeEditor1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraOptionSet1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraTextEditor1, System.ComponentModel.ISupportInitialize):EndInit().
		CAST(THIS-OBJECT:ultraNumericEditor1, System.ComponentModel.ISupportInitialize):EndInit().
		THIS-OBJECT:ResumeLayout(FALSE).
		THIS-OBJECT:PerformLayout().
	END METHOD.

	/*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	METHOD PRIVATE VOID SetupEditors():
	    DEFINE VARIABLE gridColumns AS ColumnsCollection NO-UNDO.
	    DEFINE VARIABLE gridBands   AS UltraGridBand     NO-UNDO.

        ASSIGN gridBands = CAST(ultraGrid1:DisplayLayout:Bands:GetItem(0), UltraGridBand)
		       gridColumns                    = gridBands:Columns
               gridColumns[0]:Width           = 40
			   gridColumns[1]:Width           = 60
			   gridColumns[2]:Width           = 60
			   gridColumns[3]:Width           = 100
			   gridColumns[4]:Width           = 60
			   gridColumns[5]:Width           = 80
			   gridColumns[6]:Width           = 60
			   gridColumns[7]:Width           = 60
			   gridColumns[8]:Width           = 100
               gridColumns[0]:EditorControl   = ultraNumericEditor1
			   gridColumns[1]:EditorControl   = ultraCurrencyEditor1
			   gridColumns[1]:MaskDisplayMode = MaskMode:IncludeLiterals
			   gridColumns[2]:EditorControl   = ultraCalculatorDropDown1
			   gridColumns[3]:EditorControl   = ultraOptionSet1
			   gridColumns[4]:EditorControl   = ultraComboEditor1
			   gridColumns[5]:EditorControl   = ultraDateTimeEditor1
			   gridColumns[6]:EditorControl   = ultraTextEditor1
			   gridColumns[8]:EditorControl   = new UltraProgressBar().

		ultraOptionSet1:Items:Clear().
		ultraOptionSet1:Items:Add(true,"Yes").
		ultraOptionSet1:Items:Add(false,"No").

		ultraComboEditor1:Items:Add(0,"Item 0").
		ultraComboEditor1:Items:Add(1,"Item 1").
		ultraComboEditor1:Items:Add(2,"Item 2").
	END METHOD. /*SetupEditors*/

    /*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	METHOD PRIVATE VOID Form1_Load(INPUT sender AS System.Object, INPUT e AS System.EventArgs):
    	ultraGrid1:DataSource = TypesTable.

		cboDisplayStyle:Items:Add(EmbeddableElementDisplayStyle:Office2000).
		cboDisplayStyle:Items:Add(EmbeddableElementDisplayStyle:OfficeXP).
		cboDisplayStyle:Items:Add(EmbeddableElementDisplayStyle:Office2003).
		cboDisplayStyle:Items:Add(EmbeddableElementDisplayStyle:Standard).
		cboDisplayStyle:SelectedIndex = 2.

		chkSupportThemes_CheckedChanged(THIS-OBJECT, new System.EventArgs()).

		SetupEditors().
    END METHOD. /*Form1_Load*/


    /*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	METHOD PRIVATE VOID chkSupportThemes_CheckedChanged(INPUT sender AS System.Object, INPUT e AS System.EventArgs):
	    DEFINE VARIABLE ctrl     AS System.Windows.Forms.Control   NO-UNDO.
	    DEFINE VARIABLE Controls AS System.Collections.IEnumerator NO-UNDO.

	    ASSIGN controls = THIS-OBJECT:Controls:GetEnumerator().

	    REPEAT:
	        IF NOT controls:MoveNext() THEN LEAVE.
	        ctrl = CAST(controls:current, System.Windows.Forms.Control).

	        IF TYPE-OF(ctrl, Infragistics.Win.UltraControlBase) THEN 
	        CAST(ctrl,Infragistics.Win.UltraControlBase):SupportThemes = chkSupportThemes:Checked.
	    END.
	END METHOD. /*chkSupportThemes_CheckedChanged*/

    /*------------------------------------------------------------------------------
			Purpose:  																	  
			Notes:  																	  
	------------------------------------------------------------------------------*/
	METHOD PRIVATE VOID cboDisplayStyle_SelectedIndexChanged(INPUT sender AS System.Object, INPUT e AS System.EventArgs):
		DEFINE VARIABLE displayStyle AS EmbeddableElementDisplayStyle NO-UNDO.

		ASSIGN displayStyle = CAST(cboDisplayStyle:SelectedItem, EmbeddableElementDisplayStyle)
               ultraCalculatorDropDown1:DisplayStyle = displayStyle
		       ultraComboEditor1:DisplayStyle        = displayStyle
		       ultraCurrencyEditor1:DisplayStyle     = displayStyle
		       ultraDateTimeEditor1:DisplayStyle     = displayStyle
		       ultraNumericEditor1:DisplayStyle      = displayStyle
		       ultraTextEditor1:DisplayStyle         = displayStyle.

			IF ultraGrid1:DisplayLayout:UIElement NE ? THEN
			    ultraGrid1:DisplayLayout:UIElement:DirtyChildElements(TRUE).
	END METHOD. /*cboDisplayStyle_SelectedIndexChanged*/
END CLASS.